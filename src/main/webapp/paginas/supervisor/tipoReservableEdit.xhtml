<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/layout/template.xhtml">
	<ui:define name="page-header">
		<h1>
			<h:outputText value="#{messages['tiporeservable.title']}"/>
		</h1>
		<h2>
			<h:outputText value="#{tipoReservableEdit.tipoReservableEdit.cod==null ? messages['tiporeservable.subtitle.new'] : messages['tiporeservable.subtitle.alter']}" />
		</h2>
	</ui:define>

	<ui:define name="body">
		<p:panel id="panelBody">
			<h:form id="tr">
				<p:outputPanel id="main">
					<div class="p-grid ui-fluid">
						<s:div styleClass="p-col-2" rendered="#{tipoReservableEdit.tipoReservableEdit.cod == null}">
							<p:outputLabel for="service" value="#{messages['label.servicio']}:" />
							<br/>
							<p:selectOneMenu id="service" title="#{tipoReservableEdit.tipoReservableEdit.servicio}" value="#{tipoReservableEdit.tipoReservableEdit.servicio}"
											 required="true">
								<f:selectItem itemLabel="#{messages['servicio.seleccion']}" itemValue="" />
								<f:selectItems value="#{tipoReservableEdit.listaServicios}" var="ser" itemLabel="#{ser.nombre}" itemValue="#{ser}" />
								<s:convertEntity />
							</p:selectOneMenu>
							<p:message for="service" />
						</s:div>
						<s:div styleClass="p-col-2" rendered="#{tipoReservableEdit.tipoReservableEdit.cod != null}">
							<p:outputLabel value="#{messages['label.servicio']}:" />
							<br/>
							<h:outputText value="#{tipoReservableEdit.tipoReservableEdit.servicio.nombre}" title="#{messages['label.servicio']}" styleClass="margen5"/>
						</s:div>
						<div class="p-col-4">
							<p:outputLabel for="descrip" value="#{messages['tiporeservable.description']}:" />
							<br/>
							<p:inputText label="#{tipoReservableEdit.tipoReservableEdit.descripcion}" value="#{tipoReservableEdit.tipoReservableEdit.descripcion}" required="true" id="descrip" maxlength="50" />
							<p:watermark value="#{messages['tiporeservable.descriptionw']}" for="descrip" />
							<p:message for="descrip" />
						</div>
					</div>
					<div class="p-grid ui-fluid">	
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="dmin" value="#{messages['tiporeservable.duracionminima']}:" />
							<br/>							
							<p:inputNumber id="dmin" title="#{messages['tiporeservable.duracionminima.info']}" required="true"
										   value="#{tipoReservableEdit.tipoReservableEdit.duracionMinima}" maxValue="1439" size="5" maxlength="5" minValue="0" decimalPlaces="0" />
							<br/>
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.duracionminima.info']}"/>											   
							<p:message for="dmin" />			   							
						</div>
						<div class="p-col-2 p-md-2 ">
							<p:outputLabel for="dante" value="#{messages['tiporeservable.diasantelacion']}:" />
							<br/>
							<p:inputNumber id="dante" title="#{messages['tiporeservable.diasantelacion.info']}" value="#{tipoReservableEdit.tipoReservableEdit.diasAntelacion}"
										   size="3" maxlength="3" maxValue="100" minValue="0" decimalPlaces="0" />
							<br/>
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.diasantelacion.info']}"/>				   							
							<p:message for="dante"/>
						</div>
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="vmax2" value="#{messages['tiporeservable.vistamaxima']}:" />
							<br/>
							<p:inputNumber id="vmax2" title="#{messages['tiporeservable.vistamaxima.info']}" value="#{tipoReservableEdit.tipoReservableEdit.vistaMaxima}" 
										   size="3" maxlength="3" minValue="0" maxValue="100" />							
							<br/>
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.vistamaxima.info']}"/>				   							
							<p:message for="vmax2"/>
						</div>
						<div class="p-col-12 p-sm-2  p-md-2">
							<p:outputLabel for="diasAntelacionMinima" value="#{messages['tiporeservable.diasantelacionminima']}:" />
							<br/>
							<p:inputNumber id="diasAntelacionMinima" title="#{messages['tiporeservable.diasantelacionminima.info']}" value="#{tipoReservableEdit.tipoReservableEdit.horasAntelacionMinima}"
										   size="3" maxlength="3" maxValue="1000" minValue="0" decimalPlaces="0"/>
							<br/>
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.diasantelacionminima.info']}"/>						   
						</div>
						<div class="p-col-3 p-md-3 ">
							<p:outputLabel for="horasanulacion" value="#{messages['tiporeservable.horasanulacion']}:"/>
							<br/>
							<p:inputNumber id="horasanulacion" title="#{messages['tiporeservable.horasanulacion.info']}" value="#{tipoReservableEdit.tipoReservableEdit.horasAnulacion}"
										   size="3" maxlength="3" maxValue="1000" minValue="0" decimalPlaces="0"/>
							<br/>
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.horasanulacion.info']}"/>
							<p:message for="horasanulacion"/>									
						</div>
					</div>
					<div class="p-grid ui-fluid">
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="minutosTecnico" value="#{messages['tiporeservable.minutostecnico']}:"/>
							<br/>
							<p:inputNumber id="minutosTecnico" title="#{messages['tiporeservable.minutostecnico.info']}" value="#{tipoReservableEdit.tipoReservableEdit.minutosTecnico}"
										   size="4" maxlength="4" maxValue="1425" minValue="0" decimalPlaces="0"/>
							<br/>
							<p:message for="minutosTecnico"/>									
						</div>
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="minutosTecnicoBajo" value="#{messages['tiporeservable.minutostecnicobajo']}:"/>
							<br/>
							<p:inputNumber id="minutosTecnicoBajo" title="#{messages['tiporeservable.minutostecnicobajo.info']}" value="#{tipoReservableEdit.tipoReservableEdit.minutosTecnicoBajo}"
										   size="4" maxlength="4" maxValue="1425" minValue="0" decimalPlaces="0"/>
							<br/>
							<p:message for="minutosTecnicoBajo"/>									
						</div>					
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="minutosTecnicoMedio" value="#{messages['tiporeservable.minutostecnicomedio']}:"/>
							<br/>
							<p:inputNumber id="minutosTecnicoMedio" title="#{messages['tiporeservable.minutostecnicomedio.info']}" value="#{tipoReservableEdit.tipoReservableEdit.minutosTecnicoMedio}"
										   size="4" maxlength="4" maxValue="1425" minValue="0" decimalPlaces="0"/>
							<br/>
							<p:message for="minutosTecnicoMedio"/>									
						</div>					
						<div class="p-col-2 p-md-2">
							<p:outputLabel for="minutosTecnicoAlto" value="#{messages['tiporeservable.minutostecnicoalto']}:"/>
							<br/>
							<p:inputNumber id="minutosTecnicoAlto" title="#{messages['tiporeservable.minutostecnicoalto.info']}" value="#{tipoReservableEdit.tipoReservableEdit.minutosTecnicoAlto}"
										   size="4" maxlength="4" maxValue="1425" minValue="0" decimalPlaces="0"/>
							<br/>
							<p:message for="minutosTecnicoAlto"/>									
						</div>	
						<s:div styleClass="p-col-2 p-md-2" rendered="#{tipoReservableEdit.tipoReservableEdit.cod != null}">
							<p:outputLabel for="estado" value="Estado:" />
							<br/>
							<p:selectOneRadio id="estado" label="#{tipoReservableEdit.tipoReservableEdit.estado}" value="#{tipoReservableEdit.tipoReservableEdit.estado}">
								<f:selectItem itemLabel="Alta" itemValue="ALTA" />
								<f:selectItem itemLabel="Baja" itemValue="BAJA" />
							</p:selectOneRadio>
						</s:div>
										
					</div>
					<div id="divInfoMinutosTecnico" class="p-grid ui-fluid">
						<div class="p-col-2 p-md-2">
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.minutostecnico.info']}"/>
						</div>
						<div class="p-col-6 p-md-6">
							<h:outputText styleClass="fuente07" value="#{messages['tiporeservable.minutostecnico.bajomedioalto.info']}"/>
						</div>
					</div>
				</p:outputPanel>
				<br/>
				<div class="p-grid">
					<div class="p-col-12">
						<p:commandButton type="submit" value="#{messages['label.save']}" ariaLabel="#{messages['label.save']}" label="#{messages['label.save']}"
										 title="#{messages['label.save']}" action="#{tipoReservableEdit.guardar()}" process="@form"
										 update="@form, panelBody , main, :messages" icon="fa fa-we fa-save" ajax="true"/>
						<p:commandButton id="buttonVolver" process="@this" value="#{messages['value.return']}" title="#{messages['value.return']}"
										 ariaLabel="#{messages['value.return']}" label="#{messages['value.return']}" action="#{tipoReservableEdit.volver}"
										 icon="fa fa-reply" ajax="true">
						</p:commandButton>
					</div>

				</div>
			</h:form>
			<br/>
			<p:tabView id="tabs" rendered="#{tipoReservableEdit.tipoReservableEdit.cod != null}" activeIndex="#{tipoReservableEdit.tabActivo}" >
				<p:ajax event="tabChange" listener="#{tipoReservableEdit.onTabChange}"/>
				<p:tab id="tabHorarios" title="Horarios" >
					<h:form id="formHorarios"> 
						<div class="p-grid">
							<div class="p-col-12 p-md-6 ">
								<p:dataTable id="reservableHorarioTable" value="#{tipoReservableEdit.listaReservableHorarios}" var="rh" 
											 emptyMessage="#{messages['tiporeservable.reservablehorarios.empty']}" sortBy="#{rh.fechaInicio}"
											 reflow="true" tableStyleClass="tablaAuto fuente08" styleClass="header-right" rowHover="true">
									<f:facet name="header">
										<p:commandLink action="#{tipoReservableEdit.establecerReservableHorarioCreate}" oncomplete="PF('dialogReservableHorarioAdd').show();" update=":tabs:formHorarioAdd" 
													   title="#{messages['tiporeservable.add.horario']}" ariaLabel="#{messages['tiporeservable.add.horario']}" styleClass="enlaceTexto"
													   onsuccess="saveLastFocus(event)">
											<em class="fa fa-plus"/>#{' '} 
											<h:outputText styleClass="enlaceAdd" title="#{messages['tiporeservable.add.horario']}" value="#{messages['tiporeservable.add.horario']}" />
										</p:commandLink>
									</f:facet>
									<p:column headerText="#{messages['tiporeservable.horario']}" sortBy="#{rh.fechaInicio}">
										<h:outputText value="#{rh.tipoHorario.descripcion}" title="#{messages['tiporeservable.horario']}" />
									</p:column>
									<p:column headerText="Días">
										<p:dataList styleClass="listaSinBorde fuente09" value="#{tipoReservableEdit.getListaHorarioDiaByTipohorario(rh.tipoHorario)}" var="hd" 
							   						emptyMessage="#{messages['tipohorario.horariodias.vacio']}">
											#{tipoReservableEdit.getDescripcionHorarioDia(hd)}        			   							
		   								</p:dataList>
									</p:column>
									<p:column headerText="#{messages['tiporeservable.fechaInicio']}" styleClass="centrado" sortBy="#{rh.fechaInicio}" >
										<h:outputFormat value="#{rh.fechaInicio}" title="#{messages['tiporeservable.fechaInicio']}">
											<f:convertDateTime pattern="dd/MM" />
										</h:outputFormat>
									</p:column>
									<p:column headerText="#{messages['tiporeservable.fechaFin']}" styleClass="centrado" sortBy="#{rh.fechaFin}">
										<h:outputFormat value="#{rh.fechaFin}" title="#{messages['tiporeservable.fechaFin']}">
											<f:convertDateTime pattern="dd/MM" />
										</h:outputFormat>
									</p:column>
									<p:column headerText="#{messages['tiporeservable.accion']}" styleClass="centrado">
										<p:commandLink id="btnDelete" action="#{tipoReservableEdit.eliminarReservableHorario(rh)}"
													   title="#{messages['value.delete']}" ariaLabel="#{messages['value.delete']}"
													   update="@form, :messages" process="@this">
											<em class="fa fa-trash fuente17"/>									
											<p:confirm header="#{messages['application.deleting.confirm.title']}" message="#{messages['tiporeservable.reservablehorario.confirm.delete.message']}"  icon="ui-icon-alert"/>														
										</p:commandLink>
									</p:column>
								</p:dataTable>
							</div>
						</div>
					</h:form>
					<h:form id="formHorarioAdd">	
						<p:dialog id="dialogReservableHorarioAdd" header="#{messages['tiporeservable.add.horario']}" onHide="goToLastFocus();"
								  widgetVar="dialogReservableHorarioAdd" modal="true" width="40%">
							<div class="p-grid ui-fluid">
								<div class="p-col-12 p-md-12">
									<p:outputLabel for="tipoHorario" value="#{messages['tiporeservable.reservablehorario.tipohorario']}:" />
									<br/>
									<p:selectOneMenu id="tipoHorario" required="true" value="#{tipoReservableEdit.reservableHorarioAdd.tipoHorario}"
													 var="h" filter="true" filterMatchMode="contains">
										<f:selectItem itemLabel="Seleccione el tipo de horario" itemValue=""/>
										<f:selectItems value="#{tipoReservableEdit.listaTiposHorario}" var="th" itemLabel="#{th.descripcion}" itemValue="#{th}" />
										<p:column>
											<h:outputText value="#{h.descripcion}" />
										</p:column>
										<p:column>
	       				   					<p:dataList styleClass="listaSinBorde fuente08" value="#{tipoReservableEdit.getListaHorarioDiaByTipohorario(h)}" var="hd" 
						   								emptyMessage="#{messages['tipohorario.horariodias.vacio']}" >
												#{tipoReservableEdit.getDescripcionHorarioDia(hd)}        			   							
	   										</p:dataList>
						   				</p:column>
										<s:convertEntity />
									</p:selectOneMenu>
									<p:message for="tipoHorario" />
								</div>
							</div>
							<div class="p-grid ui-fluid">
								<div class="p-col-12 p-md-6">
									<p:outputLabel for="fecini" value="#{messages['tiporeservable.reservablehorario.fechainicio']}:" />
									<br/>
									<p:calendar id="fecini" required="true" title="#{messages['tiporeservable.reservablehorario.fechainicio']}" 
												value="#{tipoReservableEdit.reservableHorarioAdd.fechaInicio}" pattern="dd/MM" size="5" mask="99/99" />
									<p:message for="fecini" />
								</div>
								<div class="p-col-12 p-md-6">
									<p:outputLabel for="fecfin" value="#{messages['tiporeservable.reservablehorario.fechafin']}:" />
									<br/>
									<p:calendar id="fecfin" required="true" title="#{messages['tiporeservable.reservablehorario.fechafin']}" 
												value="#{tipoReservableEdit.reservableHorarioAdd.fechaFin}" pattern="dd/MM" size="5" mask="99/99"/>
									<p:message for="fecfin" />
								</div>
							</div>
							<br/>
							<div class="p-grid">	
								<div class="p-col-12">								
									<p:commandButton action="#{tipoReservableEdit.crearReservableHorario}" icon="fa fa-save" value="#{messages['label.save']}" title="#{messages['label.save']}" 
														 update="@form :tabs:formHorarios :messages" oncomplete="comprobarArgsModal(xhr, status, args, 'dialogReservableHorarioAdd');" 
														 onsuccess="goToLastFocus();"/>
									<p:commandButton icon="fa fa-times" type="button" value="#{messages['label.cancel']}" title="#{messages['label.cancel']}"
													 process="@this" ariaLabel="#{messages['label.cancel']}" onclick="PF('dialogReservableHorarioAdd').hide();" />
								</div>
							</div>
						</p:dialog>	
					</h:form>
				</p:tab>
				<p:tab id="tabReservables" title="#{messages['tiporeservable.reservables']}">
					<h:form id="formReservables">
						<div class="p-grid ">
							<div class="p-col-12 p-md-12">
								<p:dataTable value="#{tipoReservableEdit.getListaReservables()}" var="_res" reflow="true" 
											 tableStyleClass="tablaAuto fuente08" rowHover="true" emptyMessage="#{messages['tiporeservable.reservables.empty']}" sortBy="#{_res.descripcion}">
									<p:column headerText="#{messages['tiporeservable.reservable.label']}" sortBy="#{_res.descripcion}">
										<h:outputText value="#{_res.descripcion}" title="#{_res.descripcion}" />
									</p:column>
									<p:column headerText="#{messages['equipos.fechaCompra']}" styleClass="centrado" sortBy="#{_res.fechaCompra}">
										<h:outputText value="#{_res.fechaCompra}" />
									</p:column>
									<p:column headerText="#{messages['value.action']}" styleClass="centrado">
										<p:commandLink process="@this" action="#{equipoEdit.establecerEquipoEdit(_res)}" title="#{messages['equipos.reservable.editar']} #{_res.descripcion}"
							  					   	   ariaLabel="#{messages['equipos.reservable.editar']} #{_res.descripcion}"> 
											<em class="fa fa-pencil-square-o fuente17" />
										</p:commandLink>
									</p:column>	
								</p:dataTable>
							</div>
						</div>	
					</h:form>
				</p:tab>
				<p:tab id="tabProductos" title="#{messages['tiporeservable.productos']}">
					<div class="p-grid ">
						<div class="p-col-12 p-md-6">
							<p:dataTable value="#{tipoReservableEdit.listaProductos}" var="pro" reflow="true"
										 tableStyleClass="tablaAuto fuente08" rowHover="true" emptyMessage="#{messages['tiporeservable.productos.empty']}" sortBy="#{pro.descripcion}">
								<p:column headerText="#{messages['producto.title']}" sortBy="#{pro.descripcion}">
									<h:outputText value="#{pro.descripcion}" />
								</p:column>
							</p:dataTable>
						</div>
					</div>		
				</p:tab>					
			</p:tabView>
			<h:form id="formConfirm">
				<p:confirmDialog id="confirm" global="true" showEffect="fade" hideEffect="fade" >
	   				<p:commandButton title="Si" label="Si" ariaLabel="Si" value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton title="No" label="No" ariaLabel="No" value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>
			</h:form>	
		</p:panel>
	</ui:define>
</ui:composition>

</html>